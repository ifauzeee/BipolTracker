# ==============================================================================
# BIPOL TRACKER - ENVIRONMENT CONFIGURATION
# ==============================================================================
# Instructions:
# 1. Copy this file to a new file named ".env"
# 2. Fill in the values appropriate for your environment.
# 3. Never commit the real .env file to version control (git).
# ==============================================================================

# ------------------------------------------------------------------------------
# 1. SERVER CONFIGURATION
# ------------------------------------------------------------------------------
# The port the Node.js server will listen on.
# Default: 3000
PORT=3000

# The UDP port for listening to incoming tracking data from ESP32 devices.
# Must match the port configured in the firmware (SECRET_UDP_PORT).
# Default: 3333
UDP_PORT=3333

# Environment mode: 'development' or 'production'.
# - development: Enhanced logging, lighter security headers.
# - production: Optimized caching, strict security headers (requires HTTPS).
NODE_ENV=development

# ------------------------------------------------------------------------------
# 2. DATABASE CONFIGURATION (SUPABASE)
# ------------------------------------------------------------------------------
# Your Supabase Project URL.
# Example: https://xyzproject.supabase.co
SUPABASE_URL=https://your-project.supabase.co

# Your Supabase Service Role Key (preferred) or Anon Key.
# Important: Ensure Row Level Security (RLS) is configured if using Anon Key.
SUPABASE_KEY=your-supabase-key-here

# ------------------------------------------------------------------------------
# 3. SECURITY & SESSION
# ------------------------------------------------------------------------------
# Secret key used to sign session cookies.
# Generate a strong key (e.g., `openssl rand -hex 32`) for production.
SESSION_SECRET=change_this_to_a_long_random_string

# Set to 'true' if serving over HTTPS (Production).
# Set to 'false' for local development (http://localhost).
USE_HTTPS=false

# Allowed Origins for CORS (Cross-Origin Resource Sharing).
# Comma-separated list of domains allowed to access the API.
# Example: https://bipol.example.com,https://admin.example.com
# Use '*' for development only.
ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# ------------------------------------------------------------------------------
# 4. TRACKING LOGIC & THRESHOLDS
# ------------------------------------------------------------------------------
# Gas Alert Threshold (MQ-2 Sensor Value).
# Values above this will trigger a "GAS HIGH" alert on the dashboard.
# Range: 0 (most sensitive) to 1024/4095 (least sensitive).
# Default: 600
GAS_ALERT_THRESHOLD=600

# Bus Stop Timeout (Minutes).
# If a bus has 0 speed for this many minutes, status changes from "Stopping" to "Parked".
# Default: 5
BUS_STOP_TIMEOUT_MINUTES=5

# Minimum Speed Threshold (km/h).
# GPS drift can cause small speed readings when stationary. 
# Speeds below this value will be recorded as 0 km/h in the database.
# Default: 3.0
UDP_MIN_SPEED_THRESHOLD=3.0

# ------------------------------------------------------------------------------
# 5. DATA RETENTION & CLEANUP
# ------------------------------------------------------------------------------
# How many hours to keep high-frequency tracking data in the database?
# Old data is automatically deleted by the background task.
# Default: 24 (1 day)
DATA_RETENTION_HOURS=24

# ------------------------------------------------------------------------------
# 6. PERFORMANCE & RATE LIMITING
# ------------------------------------------------------------------------------
# Rate Limit Window (Milliseconds). 
# The timeframe for counting requests (e.g., 60000 = 1 minute).
RATE_LIMIT_WINDOW_MS=60000

# Max requests per IP per window for general API endpoints.
# Default: 100
RATE_LIMIT_MAX=100

# Max requests per IP per window for Login/Auth endpoints (Brute-force protection).
# Default: 5
RATE_LIMIT_LOGIN_MAX=5

# Server-side memory cache duration (Milliseconds).
# How long to cache DB query results (e.g., bus locations, info) in RAM.
# Default: 5000 (5 seconds)
CACHE_TTL_MS=5000

# ------------------------------------------------------------------------------
# 7. ADMIN SEEDING (Optional)
# ------------------------------------------------------------------------------
# Credentials used by `node scripts/seed_admin.js` to create the initial admin user.
ADMIN_DEFAULT_USER=admin
ADMIN_DEFAULT_PASS=admin123

# ==============================================================================
# HARDWARE CONFIGURATION REFERENCE (For Firmware - DO NOT EDIT HERE)
# ==============================================================================
# The following values must be configured in `firmware/arduino_secrets.h`:
#
# #define SECRET_APN "internet"          // APN Provider
# #define SECRET_SERVER_IP "YOUR_IP"     // Must match public IP/Domain of this server
# #define SECRET_UDP_PORT 3333           // Must match UDP_PORT above
# ==============================================================================